<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
	<head>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
		/>

		<title>
			Как строку букв превратить в боль для разработчика, или Что такое
			интерфейсы в биотехе
		</title>

		<link rel="stylesheet" href="dist/reset.css" />
		<link rel="stylesheet" href="dist/reveal.css" />
		<link rel="stylesheet" href="dist/theme/dracula.css" />
		<link rel="stylesheet" href="custom_styles.css" />
		<link rel="icon" href="favicon.ico" type="image/x-icon" />

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css" />
	</head>
	<body>
		<!--	
<pre class="fragment">
						<code class="javascript"  data-trim data-noescape data-line-numbers="1|3|4">
							document.querySelectorAll('*').length;

							// -> 132419
							// 132419 / 161 = 822
						</code>
					</pre>
					-->
		<div class="reveal">
			<ul class="slides">
				<!--Вступление-->
				<section style="text-align: left">
					<h3 style="font-size: 60px">
						Как строку букв превратить в боль для разработчика, или <br />Что
						такое интерфейсы в биотехе
					</h3>
					<br />
					<div style="display: flex; flex-direction: row; align-items: center">
						<img
							src="img/me.jpg"
							width="120"
							alt="Мария Кондаурова"
							style="border-radius: 50%; border: 5px solid white"
						/>
						<div
							style="margin-left: 30px; display: flex; flex-direction: column"
						>
							<b>Мария Кондаурова</b>
							<small>BIOCAD</small>
						</div>
					</div>
				</section>
				<section>
					<div style="display: flex; flex-direction: row">
						<img src="img/me_and_llama.jpg" alt="Я и ламы" width="40%" />
						<div style="margin-left: 20px">
							<p style="text-align: left">
								Разрабатываю интерфейсы в
								<b>Департаменте Вычислительной Биологии</b> в
								<b>BIOCAD</b>
							</p>
							<table style="margin-top: 40px">
								<tr>
									<td>telegram</td>
									<td>@Momomash</td>
								</tr>
								<tr>
									<td>twitter</td>
									<td>@mari_momos</td>
								</tr>
								<tr>
									<td>github</td>
									<td>@Momomash</td>
								</tr>
							</table>
						</div>
					</div>
				</section>
				<!--конец вступления-->
				<!-- Глава 1. Что за строка букв? start -->
				<section>
					<h2>Глава 1. Что за строка букв?</h2>
				</section>
				<section>
					<h3>Иммунитет</h3>
					<p>
						(здесь будет картинка или ряд слайдов, описывающих пример с
						иммунитетом)
					</p>
					<!--TODO: добавить слайды/картинку про иммунитет-->
				</section>
				<section data-background-image="img/1/001.jpeg"></section>
				<section data-background-image="img/1/002.jpeg"></section>
				<section data-background-image="img/1/003.jpeg"></section>
				<section data-background-image="img/1/004.jpeg"></section>
				<section data-background="black">
					<video data-autoplay src="img/1/macrophage.mp4" width="80%"></video>
					<p>Макрофаг охотится на бактерию</p>
				</section>
				<section data-background-image="img/1/005.jpeg"></section>
				<section data-background-image="img/1/006.jpeg"></section>
				<section data-background-image="img/1/007.jpeg"></section>
				<section data-background-image="img/1/008.jpeg"></section>
				<section data-background-image="img/1/009.jpeg"></section>
				<section data-background-image="img/1/010.jpeg"></section>
				<section data-background-image="img/1/011.jpeg"></section>
				<section data-background-image="img/1/012.jpeg"></section>
				<section data-background-image="img/1/013.jpeg"></section>
				<section data-background-image="img/1/014.jpeg"></section>
				<section>
					<div
						style="
							display: flex;
							flex-direction: column;
							justify-content: center;
							align-items: center;
						"
					>
						<video data-autoplay src="img/1/3d.mov" width="80%"></video>
						<a href="https://www.rcsb.org/3d-view/6WTT/1" target="_blank"
							>Источник</a
						>
					</div>
				</section>
				<section>
					<img src="img/1/structure.png" />
				</section>
				<section>
					<img src="img/1/structure1.png" />
				</section>
				<section>
					<div style="display: flex; flex-direction: row; align-items: center">
						<p
							style="
								margin-right: 40px;
								text-align: left;
								word-break: break-word;
							"
						>
							MADQLTEEQIAEFKEAFSLFDKDGDGTITTKELGTVMRSLGQNPTEAELQDMINEVDADGNGTIDFPEFLTMMARKMKDTDSEEEIREAFRVFDKDGNGYISAAELRHVMTNLGEKLTDEEVDEMIREADIDGDGQVNYEEFVQMMTAK
						</p>
						<img src="img/1/nucleo.png" width="50%" />
					</div>
					<a href="https://www.rcsb.org/sequence/8X43#B" target="_blank"
						>Источник</a
					>
				</section>
				<section>
					<div style="display: flex; flex-direction: row; align-items: center">
						<p
							style="
								margin-right: 40px;
								text-align: left;
								word-break: break-word;
							"
						>
							MADQLTEEQIAEFKEAFSLFDKDGDGTITTKELGTVMRSLGQNPTEAELQDMINEVDADGNGTIDFPEFLTMMARKMKDTDSEEEIREAFRVFDKDGNGYISAAELRHVMTNLGEKLTDEEVDEMIREADIDGDGQVNYEEFVQMMTAK
						</p>
						<img src="img/1/magic.png" width="50%" />
					</div>
					<a href="https://www.rcsb.org/sequence/8X43#B" target="_blank"
						>Источник</a
					>
				</section>
				<section>
					<h3>Зачем айти то?</h3>
				</section>
				<section>
					<blockquote>
						Сервис должен
						<span class="fragment highlight-green" data-fragment-index="1"
							>помогать принимать рациональные решения на основании всех
							данных</span
						>, которые были получены на этапе ранней разработки.
					</blockquote>
				</section>
				<!-- Глава 1. Что за строка букв? end -->
				<!-- Глава 2. Про строку букв: start -->
				<section>
					<h2>Глава 2. Про строку букв:</h2>
				</section>
				<section>
					<div class="r-stack">
						<img src="img/2/seq1.png" />
						<img
							src="img/2/seq2.png"
							class="fragment"
							data-fragment-index="2"
						/>
					</div>
					<div class="r-stack">
						<img
							src="img/2/code1.png"
							class="fragment"
							data-fragment-index="1"
						/>
						<img
							src="img/2/code2.png"
							class="fragment"
							data-fragment-index="3"
						/>
					</div>
				</section>
				<section>
					<div class="r-stack">
						<img src="img/2/seq3.png" />
						<img src="img/2/seq4.png" class="fragment" />
					</div>
				</section>
				<section>
					<img src="img/2/meme1.png" />
				</section>
				<section>
					<p>MADQLTEEQIAEFKEAFSLFDKDGDGT__TKELGTV...</p>
					<p>MADQLTEEQIAEFKEAFSLFDKDGD<b>CKITT</b>K<b>VG</b>GT...</p>
				</section>
				<section>
					<div class="r-stack">
						<img src="img/2/seq5.png" />
						<img src="img/2/seq6.png" class="fragment" />
					</div>
				</section>
				<section>
					<h3>Будут ли проблемы?</h3>
				</section>
				<section>
					<video data-autoplay loop src="img/2/mov1.mov"></video>
					<p style="color: red" class="fragment">
						Потеряли функцию копирования
					</p>
					<p class="fragment">(Починили через <b>onCopy</b>)</p>
				</section>
				<section>
					<video data-autoplay loop src="img/2/mov2.mov"></video>
					<p style="color: red" class="fragment">
						Потеряли поиск по странице (благо есть большой поиск в приложении)
					</p>
				</section>
				<section>
					<img src="img/2/meme2.png" width="60%" />
				</section>
				<section data-background="img/2/meme3.jpg"></section>
				<section>
					<video data-autoplay loop src="img/2/mov3.mov"></video>
					<p style="color: red; font-weight: bold" class="fragment">
						DOM распух
					</p>
				</section>
				<section>
					<div class="r-stack">
						<img src="img/2/error1.png" />
						<img src="img/2/error2.png" class="fragment" />
						<img src="img/2/error3.png" class="fragment" />
						<img src="img/2/error4.png" class="fragment" />
					</div>
				</section>
				<section>
					<div class="r-stack">
						<p style="font-weight: bold">
							121 символ
							<span class="fragment">* 3</span>
							<span class="fragment">* 2</span>
							<span class="fragment">= 726</span>
							<span class="fragment"> * N (161)</span>
						</p>
						<img src="img/2/meme4.jpeg" class="fragment" />
					</div>
				</section>
				<!-- Глава 2. Про строку букв: end -->

				<!-- Глава 3. Решение: start -->
				<section>
					<h2>Глава 3. Решение:</h2>
				</section>
				<section>
					<p style="text-align: left">Варианты:</p>
					<ul style="list-style: none">
						<li>Svg</li>
						<li>Canvas</li>
						<li>Custom highlighter API</li>
					</ul>
				</section>
				<section>
					<h3 style="text-align: left">Svg</h3>
					<div
						style="display: flex; flex-direction: row; align-items: flex-start"
					>
						<ul style="list-style: none">
							<li class="fragment" data-fragment-index="1">+ хорошо знакомо</li>
							<li class="fragment" data-fragment-index="2">
								+ может вести себя как текст
							</li>
							<br />
							<li class="fragment" data-fragment-index="3">- DOM не меньше</li>
							<li class="fragment" data-fragment-index="3">
								- позиционирование каждой буквы
							</li>
						</ul>
						<div class="r-stack">
							<video
								data-autoplay
								loop
								src="img/3/mov1.mov"
								data-fragment-index="2"
								class="fragment"
							></video>
							<img
								src="img/3/code1.png"
								class="fragment"
								data-fragment-index="3"
								width="100%"
							/>
						</div>
					</div>
				</section>
				<section>
					<h3 style="text-align: left">Canvas</h3>
					<ul style="list-style: none" class="fragment">
						<li class="fragment">+ быстро-модно-молодежно</li>
						<br />
						<li class="fragment">- вообще не текст</li>
					</ul>
				</section>
				<section>
					<h3>Custom highlighter API</h3>
				</section>
				<section data-background="img/3/me1.png"></section>
				<section>
					<div class="r-stack">
						<img src="img/3/browsers2.png" />
						<img src="img/3/browsers1.png" class="fragment" />
						<img src="img/3/browsers3.png" class="fragment" />
					</div>
				</section>
				<section>
					<video data-autoplay src="img/3/highlight1.mov" width="80%"></video>
				</section>
				<section>
					<img src="img/3/highlight2.png" />
					<img src="img/3/highlight3.png" class="fragment" />
				</section>
				<section>
					<h4>Как готовить?</h4>
				</section>
				<section>
					<h5 style="text-align: left">1. Create ranges</h5>
					<div class="r-stack">
						<pre>
						<code class="javascript"  data-trim data-noescape data-line-numbers="0|1|3-12|14-25|18-25|28-34">
							const content = document.querySelector(".content");

							const treeWalker = document.createTreeWalker(
								content, NodeFilter.SHOW_TEXT
							);

							const allTextNodes = [];
							let currentNode = treeWalker.nextNode();
							while (currentNode) {
								allTextNodes.push(currentNode);
								currentNode = treeWalker.nextNode();
							}

							const ranges = allTextNodes.map((el) => {
								return { el, text: el.textContent.toLowerCase() };
							})
							.map(({ text, el }) => {
								const indices = [];
								let startPos = 0;
								while (startPos < text.length) {
								const index = text.indexOf(query, startPos);
								if (index === -1) break;
									indices.push(index);
									startPos = index + str.length;
								}


								return indices.map((index) => {
									const range = new Range();
									range.setStart(el, index);
									range.setEnd(el, index + str.length);
									return range;
								  });
							});
						</code>
					</pre>
						<img src="img/3/seq1.png" class="fragment" width="80%" />
						<pre class="fragment">
							<code class="javascript"  data-trim data-noescape data-line-numbers="1-3|5|7-15">
								const getRangesForMatchedSubstrings =
									(text: string, substrings: string[]): number[][]
								=> {...};

								const ranges = getRangesForMatchedSubstrings(sequence, cdrs);

								const rangesForNodes = allTextNodes.flatMap((textNode) =>
									ranges.map((r) => {

										const range = new Range();
										range.setStart(textNode, r[0]);
										range.setEnd(textNode, r[1]);

										return range;
									}),
								);
							</code>
						</pre>
					</div>
				</section>
				<section>
					<h5 style="text-align: left">2. Init highlighter</h5>
					<pre>
						<code class="javascript"  data-trim data-noescape data-line-numbers="1|3">
							const cdrsHighlight = new Highlight(...rangesForNodes.flat());

							CSS.highlights.set("cdrs", cdrsHighlight);
						</code>
					</pre>
				</section>
				<section>
					<h5 style="text-align: left">3. Add styles</h5>
					<pre>
						<code class="javascript"  data-trim data-noescape data-line-numbers="1-5|7-14">
							// css
							::highlight(cdrs) {
								textDecoration: underline;
								text-decoration-thickness: 2px;
							}

							// styled
							export const Sequence = styled(Typography)(() => ({
								...
								'&::highlight(cdrs)': {
									textDecoration: 'underline',
									textDecorationThickness: 2px
								},
							}));
						</code>
					</pre>
				</section>
				<section>
					<img src="img/3/seq2.png" />
				</section>
				<section>
					<pre>
						<code class="javascript"  data-trim data-noescape data-line-numbers="1-5|7-14|16-20">
							export enum AlignmentLegend {
								Cysteine = 'Cysteine',
								Hydrophobic = 'Hydrophobic',
								...
							}

							export const mapAlignmentLegendByAmino:Record <
								string, AlignmentLegend
							> = {
								C: Cysteine,
								A: Hydrophobic,
								I: Hydrophobic,
								...
							};

							 const result: Record<\AlignmentLegend, Range[]> = {
								[Cysteine]: [],
								[Hydrophobic]: [],
								...
							};
						</code>
					</pre>
				</section>

				<section>
					<ul style="list-style: none">
						<li>+ чистый css</li>
						<li>+ уменьшение DOM</li>
						<li>+ ведет себя как текст</li>
					</ul>
				</section>

				<!--Здесь куча слайдов с реализацией и аналитикой-->

				<section>
					<h3>Зачем оно вам?</h3>
				</section>
				<section>
					<ul style="list-style: none">
						<li>Поиск</li>
						<li>Редактор</li>
						<!--TODO: здесь скрин из гитлаба что выделение в пр-ах - это спаны и алерт от гитлаба-->
						<li>
							<!--TODO: Посмотреть и добавить еще примеры от разработчиков-->
						</li>
					</ul>
				</section>
				<section>
					<h3>Подводные камни</h3>
				</section>
				<section>
					<ul style="list-style: none">
						<li class="fragment">- Нет в firefox</li>
						<!--TODO: показать скрин из ишью с поддержкой (браузер — дата внедрения)-->
						<li class="fragment">- Нет в typescript</li>
						<!--TODO: показать скрин из ишью про неподдержку беты-->
						<li class="fragment">- Придется разобраться с <b>Range</b></li>
					</ul>
				</section>
				<!-- Глава 3. Решение: end -->
				<!-- Глава 4. Выводы: start -->
				<section>
					<h2>Глава 4. Выводы:</h2>
				</section>
				<section>
					<p>Про задачи и <b>биотех</b></p>
				</section>
				<section>
					<video data-autoplay src="img/1/3d.mov" width="80%"></video>
				</section>
				<section>
					<img src="img/2/seq3.png" />
				</section>
				<section>
					<p>Про преждевременные оптимизации</p>
				</section>
				<section>
					<p>«Назад к <s>истокам</s> css»</p>
				</section>
				<section>
					<p><i>Про новые API</i></p>
				</section>
				<section>
					<div style="display: flex; flex-direction: row; align-items: center">
						<img src="img/4/llama1.jpg" width="33%" />
						<img src="img/4/llama2.jpg" width="33%" />
						<img src="img/4/llama3.jpg" width="33%" />
					</div>
				</section>
				<section>
					<div
						style="
							display: flex;
							flex-direction: row;
							align-items: center;
							justify-content: space-around;
						"
					>
						<div>
							<img
								src="img/me.jpg"
								width="250"
								alt="Мария Кондаурова"
								style="border-radius: 50%; border: 5px solid white"
							/>
							<p>BIOCAD</p>
						</div>

						<table>
							<tr>
								<td>telegram</td>
								<td>@Momomash</td>
							</tr>
							<tr>
								<td>twitter</td>
								<td>@mari_momos</td>
							</tr>
							<tr>
								<td>github</td>
								<td>@Momomash</td>
							</tr>
						</table>
					</div>
				</section>
			</ul>
			<!-- finish! -->
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				transition: 'none',
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
			});
		</script>
	</body>
</html>
